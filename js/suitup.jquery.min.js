jQuery._createElement=function(a,b){return $($.extend(document.createElement(a),b))};
jQuery.suitUp={controls:"italic bold | formatblock#<h1> formatblock#<h2> formatblock#<h3> formatblock#<p> | fontname link".split(" "),commands:{bold:null,italic:null,createlink:function(a){a(window.prompt("URL:",""))},fontname:{Arial:"arial",Times:"times"}},custom:{link:function(){return jQuery._createElement("a",{className:"suitup-control",href:"#"}).attr({"data-command":"createlink"}).on("click",function(){$.suitUp.hasSelectedNodeParent("a")?document.execCommand("unlink",!1,null):document.execCommand("createlink",
!1,window.prompt("URL:",""))})}},getSelection:function(){var a;if(window.getSelection)try{a=window.getSelection().getRangeAt(0)}catch(b){}else document.selection&&(a=document.selection.createRange());return a},restoreSelection:function(a){var b;a&&(window.getSelection?(b=window.getSelection(),0<b.rangeCount&&b.removeAllRanges(),b.addRange(a)):document.createRange?window.getSelection().addRange(a):document.selection&&a.select())},getSelectedNode:function(){if(document.selection)return document.selection.createRange().parentElement();
var a=window.getSelection();if(0<a.rangeCount)return a.getRangeAt(0).endContainer},hasSelectedNodeParent:function(a){var b=this.getSelectedNode(),d=!1;for(a=a.toUpperCase();b&&"BODY"!==b.tagName;){if(b.tagName===a){d=!0;break}b=b.parentNode}return d}};
jQuery.fn.suitUp=function(a){var b=jQuery,d=b.suitUp,n,p,u=b.suitUp.commands,v=b.suitUp.custom,h=document,g=b._createElement,y=d.getSelection,z=d.restoreSelection;a=a||b.suitUp.controls;a=a instanceof Array?a:Array.prototype.slice.call(arguments);return this.each(function(){for(var d=this,e=b(this).hide(),q,r,f,w,l=g("div",{className:"suitup"}).width(e.width()),j=g("div",{className:"suitup-controls"}).appendTo(l),t=g("div",{className:"suitup-editor",contentEditable:!0}).keyup(function(){m();s()}).focus(function(){p=
this}).mouseup(function(){s()}).html(d.value).height(e.height()).appendTo(l),m=function(){d.value=t.html()},s=function(){q=q||b("a.suitup-control",j);q.removeClass("active").each(function(){var a=b(this),c=a.data("command"),k=a.data("value");try{k=k?k.replace("<","").replace(">",""):k,h.queryCommandValue(c)===(k||"true")&&a.addClass("active")}catch(d){}try{h.queryCommandState(c)&&a.addClass("active")}catch(e){}});r=r||b("select.suitup-control",j);r.each(function(){var a=b(this),c=a.data("command"),
d=h.queryCommandValue(c),a=a.children("option").filter(function(){return d&&this.value.toLowerCase()===d.toLowerCase()});a.length&&(this.value=a.val())})},x=0,c=a[0];x<a.length;c=a[++x])if(f=c.split("#"),c=f[0],e=f[1],"|"===c)g("span",{className:"suitup-separator"}).appendTo(j);else if(c in u||f[1])if(e=e||u[c],f=typeof e,e&&"object"===f)w=g("select",{className:"suitup-control"}).attr("data-command",c).appendTo(j).on("change",{command:c},function(a){h.execCommand(a.data.command,null,this.value);m()}),
b.each(e,function(a,b){g("option",{value:b}).html(a).appendTo(w)});else g("a",{href:"#",className:"suitup-control"}).attr({"data-command":c,"data-value":"function"===f?"_DYNAMIC_":e}).appendTo(j).on("click",{command:c,value:e,typeofValue:f},function(a){var b=a.data.command,c=a.data.value;a=a.data.typeofValue;(p!==t[0]||!n)&&t.focus();"function"===a?(n=y(),c(function(a){p.focus();z(n);h.execCommand(b,null,a);m()})):(h.execCommand(b,null,c),m(),s());return!1});else c in v&&v[c](d,l[0]).appendTo(j);
l.insertBefore(d)})};