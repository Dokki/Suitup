jQuery._createElement=function(a,b){return $($.extend(document.createElement(a),b))};
jQuery.suitUp={controls:"italic bold | formatblock#<h1> formatblock#<h2> formatblock#<h3> formatblock#<p> | fontname link".split(" "),commands:{createlink:function(a){a(window.prompt("URL:",""))},fontname:{Arial:"arial",Times:"times"}},custom:{link:function(){return jQuery._createElement("a",{className:"suitup-control",href:"#"}).attr({"data-command":"createlink"}).on("click",function(){$.suitUp.hasSelectedNodeParent("a")?document.execCommand("unlink",!1,null):document.execCommand("createlink",!1,
window.prompt("URL:",""))})}},getSelection:function(){var a;if(window.getSelection)try{a=window.getSelection().getRangeAt(0)}catch(b){}else document.selection&&(a=document.selection.createRange());return a},restoreSelection:function(a){var b;a&&(window.getSelection?(b=window.getSelection(),0<b.rangeCount&&b.removeAllRanges(),b.addRange(a)):document.createRange?window.getSelection().addRange(a):document.selection&&a.select())},getSelectedNode:function(){if(document.selection)return document.selection.createRange().parentElement();
var a=window.getSelection();if(0<a.rangeCount)return a.getRangeAt(0).endContainer},hasSelectedNodeParent:function(a){var b=this.getSelectedNode(),d=!1;for(a=a.toUpperCase();b&&"BODY"!==b.tagName;){if(b.tagName===a){d=!0;break}b=b.parentNode}return d}};
jQuery.fn.suitUp=function(a){var b=jQuery,d=b.suitUp,p,q,x=b.suitUp.commands,v=b.suitUp.custom,h=document,f=b._createElement,y=d.getSelection,z=d.restoreSelection;a=a||b.suitUp.controls;a=a instanceof Array?a:Array.prototype.slice.call(arguments);return this.each(function(){for(var d=this,k=b(this).hide(),r,s,g,e,w,m=f("div",{className:"suitup"}).width(k.width()),j=f("div",{className:"suitup-controls"}).appendTo(m),u=f("div",{className:"suitup-editor",contentEditable:!0}).keyup(function(){n();t()}).focus(function(){q=
this}).mouseup(function(){t()}).html(d.value).height(k.height()).appendTo(m),n=function(){d.value=u.html()},t=function(){r=r||b("a.suitup-control",j);r.removeClass("active").each(function(){var a=b(this),c=a.data("command"),l=a.data("value");try{l=l?l.replace("<","").replace(">",""):l,h.queryCommandValue(c)===(l||"true")&&a.addClass("active")}catch(d){}try{h.queryCommandState(c)&&a.addClass("active")}catch(e){}});s=s||b("select.suitup-control",j);s.each(function(){var a=b(this),c=a.data("command"),
d=h.queryCommandValue(c),a=a.children("option").filter(function(){return d&&this.value.toLowerCase()===d.toLowerCase()});a.length&&(this.value=a.val())})},k=0,c=a[0];k<a.length;c=a[++k])if(g=c.split("#"),c=g[0],e=g[1],"|"===c)f("span",{className:"suitup-separator"}).appendTo(j);else if(c in v)v[c](d,m[0]).appendTo(j);else if(e=e||x[c]||null,g=typeof e,e&&"object"===g)w=f("select",{className:"suitup-control"}).attr("data-command",c).appendTo(j).on("change",{command:c},function(a){h.execCommand(a.data.command,
null,this.value);n()}),b.each(e,function(a,b){f("option",{value:b}).html(a).appendTo(w)});else f("a",{href:"#",className:"suitup-control"}).attr({"data-command":c,"data-value":"function"===g?"_DYNAMIC_":e}).appendTo(j).on("click",{command:c,value:e,typeofValue:g},function(a){var b=a.data.command,c=a.data.value;a=a.data.typeofValue;(q!==u[0]||!p)&&u.focus();"function"===a?(p=y(),c(function(a){q.focus();z(p);h.execCommand(b,null,a);n()})):(h.execCommand(b,null,c),n(),t());return!1});m.insertBefore(d)})};